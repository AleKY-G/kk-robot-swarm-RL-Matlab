<!--
 * @Author: Loren
 * @Date: 2022-04-12 11:49:28
 * @LastEditTime: 2022-04-12 16:48:21
 * @FilePath: /misaro_ws/misaro-doc/src/软件环境安装.md
 * @Description: 软件环境安装步骤
 * 
 * Copyright (c) 2022 by AmovLab, All Rights Reserved. 
-->
# 软件环境安装

## 综述

建议使用阿木实验室配套的系统镜像。点击[系统镜像下载](TODO)

如果您想自行搭建环境，请参考以下步骤。

## Ubuntu安装

1. [虚拟机安装](https://blog.csdn.net/lengyuefeng212/article/details/119255073)
2. [双系统安装](https://zhuanlan.zhihu.com/p/462123557)

## ROS安装

ROS版本选择 Melodic

ROS安装参考： [ROS官方教程](http://wiki.ros.org/melodic/Installation/Ubuntu) 

补充：官方教程第1.3步 Set up your keys 的命令修改为

```bash
sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
```

## 相机驱动安装
1. 进入[海康威视官网](https://www.hikrobotics.com/cn/machinevision/service/download?module=0)，选择`机器视觉工业相机客户端MVS V2.1.0（Linux）`进行下载。
2. 下载完成以后，解压。解压后将会显示适应各种架构的计算机的压缩包。这里选择 `MVS-2.1.0_x86_64_20201228.tar.gz` 这个压缩包进行安装。(根据实际情况，版本可能有小更新)
3. 解压第2步选择的压缩包
   ```bash
   tar -xvzf MVS-2.1.0_x86_64_20201228.tar.gz
   cd MVS-2.1.0_x86_64_20201228
   sudo bash setup.sh
   ```
    相机驱动将会安装在 `/opt/MVS` 中
    
    启动相机界面为 `cd /opt/MVS/bin && ./MVS.sh`，界面如图1所示：

    相机驱动的动态链接库路径为 `/opt/MVS/lib/64`

    相机驱动头文件路径为 `/opt/MVS/include/`

4. 安装完毕后，将海康威视的动态库加入到系统动态库中。否则程序将无法运行。
   ```
   cd /etc/ld.so.conf.d
   sudo vim hik.conf ## 如果不会vim,则输入 sudo gedit hik.conf
   #在第一行加入相机驱动的动态链接库路径
   /opt/MVS/lib/64
   sudo ldconfig # 刷新配置
   ```


## Apriltag以及apritag_ros安装

[apriltag官方简介](https://april.eecs.umich.edu/software/apriltag.html)

[apriltao_ros官方简介](http://wiki.ros.org/apriltag_ros)

Misao项目采用的标签家族是 `Tag36h11`，尺寸是`7cm`。 详情见 `misaro-doc/apritags1-50.pdf`。您也可以通过软件自动生成该家族标签。详情点击[通过openmv生成apriltag标签](https://blog.csdn.net/wangmj_hdu/article/details/112933915)

### Apriltag安装
```bash
mkdir -p ~/misaro_ws/src
cd ~/misaro_ws/
git clone https://github.com/AprilRobotics/apriltag.git
cd apriltag
mkdir build
cmake ..
make -j4
sudo make install
```
1. Apriltag相关头文件将会被安装在 `/usr/local/include/apriltag`
2. Apriltag相关的库将会被安装在 `/usr/local/lib/`
3. 有关Apriltag的相关信息，可以访问其[GitHub项目主页](https://github.com/AprilRobotics/apriltag)

### apriltag_ros安装
Misaro项目针对apriltag_ros这个功能包做了二次开发和修改，其安装见 Misaro项目安装 部分。

## Misaro项目安装

```bash
cd ~/misaro_ws/src
git clone TODO
cd ~/misaro_ws
catkin_make
```

至此，整个misaro项目的软件环境安装完毕。